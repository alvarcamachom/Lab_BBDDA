2023-01-31 19:35:33.764 CET [1057] LOG:  starting PostgreSQL 14.6 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
2023-01-31 19:35:33.765 CET [1057] LOG:  listening on IPv6 address "::1", port 5432
2023-01-31 19:35:33.765 CET [1057] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-31 19:35:33.766 CET [1057] LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
2023-01-31 19:35:33.767 CET [1058] LOG:  database system was shut down at 2023-01-31 19:35:33 CET
2023-01-31 19:35:33.768 CET [1057] LOG:  database system is ready to accept connections
2023-01-31 19:37:48.416 CET [1179] ERROR:  relation "para" does not exist at character 15
2023-01-31 19:37:48.416 CET [1179] STATEMENT:  select * from para;
2023-01-31 19:37:52.581 CET [1057] LOG:  received fast shutdown request
2023-01-31 19:37:52.581 CET [1057] LOG:  aborting any active transactions
2023-01-31 19:37:52.582 CET [1057] LOG:  background worker "logical replication launcher" (PID 1064) exited with exit code 1
2023-01-31 19:37:52.582 CET [1059] LOG:  shutting down
2023-01-31 19:37:52.588 CET [1057] LOG:  database system is shut down
48083824R LOG:  starting PostgreSQL 14.6 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-01-31 19:37:52 CET
48083824R LOG:  database system is ready to accept connections
48083824R [local]ERROR:  relation "para" does not exist at character 15
48083824R [local]STATEMENT:  select * from para;
48083824R LOG:  received fast shutdown request
48083824R LOG:  aborting any active transactions
48083824R LOG:  background worker "logical replication launcher" (PID 1210) exited with exit code 1
48083824R LOG:  shutting down
48083824R LOG:  database system is shut down
2023-01-31 18:39:17.062 GMT [1287] LOG:  syntax error in file "/Users/alvarocamacho/Library/Application Support/Postgres/var-14/postgresql.conf" line 546, near token "%"
2023-01-31 18:39:17.062 GMT [1287] FATAL:  configuration file "/Users/alvarocamacho/Library/Application Support/Postgres/var-14/postgresql.conf" contains errors
48083824R LOG:  starting PostgreSQL 14.6 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-01-31 19:39:15 CET
48083824R LOG:  database system is ready to accept connections
48083824R [local]ERROR:  relation "para" does not exist at character 15
48083824R [local]STATEMENT:  select * from para;
48083824R [local]LOG:  statement: CREATE DATABASE PL1;
48083824R [local]LOG:  statement: CREATE TABLE sales (Region text, Country text, Item_Type text, Sales_Channel text, Order_Priority char(1), Order_Date date, Order_ID text PRIMARY KEY, Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision);
48083824R ::1(49610)LOG:  statement: ALTER TABLE public.sales
	    ALTER COLUMN sales_channel TYPE character varying(7) COLLATE pg_catalog."default";
	
	ALTER TABLE public.sales
	    ALTER COLUMN order_id TYPE character varying(9) COLLATE pg_catalog."default";
48083824R [local]ERROR:  missing data for column "country"
48083824R [local]CONTEXT:  COPY sales, line 2: "Sub-Saharan Africa;Togo;Meat;Online;H;20/01/2010;100000001;12/02/2010;5526;421.89;364.69;2331364.14;..."
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales1.csv' csv header delimiter E'\t' NULL 'NULL' encoding 'UTF8';
48083824R [local]ERROR:  date/time field value out of range: "20/01/2010"
48083824R [local]HINT:  Perhaps you need a different "datestyle" setting.
48083824R [local]CONTEXT:  COPY sales, line 2, column order_date: "20/01/2010"
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales1.csv' csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
48083824R [local]ERROR:  date/time field value out of range: "20/01/2010"
48083824R [local]HINT:  Perhaps you need a different "datestyle" setting.
48083824R [local]CONTEXT:  COPY sales, line 2, column order_date: "20/01/2010"
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales1.csv' csv header delimiter ';' NULL 'NULL' encoding 'UTF8';
48083824R [local]ERROR:  date/time field value out of range: "20/01/2010"
48083824R [local]HINT:  Perhaps you need a different "datestyle" setting.
48083824R [local]CONTEXT:  COPY sales, line 2, column order_date: "20/01/2010"
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales1.csv' csv header delimiter ';' NULL 'NULL' encoding 'UTF8';
48083824R LOG:  received fast shutdown request
48083824R LOG:  aborting any active transactions
48083824R LOG:  background worker "logical replication launcher" (PID 1306) exited with exit code 1
48083824R LOG:  shutting down
48083824R LOG:  database system is shut down
48083824R LOG:  starting PostgreSQL 14.6 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-02-07 12:47:45 CET
48083824R LOG:  database system is ready to accept connections
48083824R [local]ERROR:  syntax error at or near "sales" at character 71
48083824R [local]STATEMENT:  SELECT pg_relation_filepath('sales’);
	
	;
	SELECT pg_relation_filepath('sales');
	'
	)
	-
	;
48083824R [local]ERROR:  column "relid" does not exist at character 50
48083824R [local]HINT:  Perhaps you meant to reference the column "pg_class.relam" or the column "pg_class.relkind".
48083824R [local]STATEMENT:  SELECT relname, relpages, pg_total_relation_size(relid) as size
	FROM pg_class
	WHERE relkind = 'r'
	ORDER BY relpages DESC;
48083824R ::1(50279)ERROR:  syntax error at or near "FROM" at character 372
48083824R ::1(50279)STATEMENT:  
	       /* SELECT relname, relpages
	        FROM pg_class,
	             (SELECT reltoastrelid
	              FROM pg_class
	              WHERE relname = 'sales') AS ss
	        WHERE oid = ss.reltoastrelid OR
	              oid = (SELECT indexrelid
	                     FROM pg_index
	                     WHERE indrelid = ss.reltoastrelid)
	        ORDER BY relname;*/
			
			 FROM pg_class c, pg_class c2, pg_index i
	        WHERE c.relname = 'sales' AND
	              c.oid = i.indrelid AND
	              c2.oid = i.indexrelid
	        ORDER BY c2.relname;
48083824R ::1(51949)ERROR:  column "‘europe’" does not exist at character 135
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	SELECT COUNT (DISTINCT country) FROM sales WHERE region=‘Europe’;
48083824R ::1(51949)ERROR:  function char_lenght(text) does not exist at character 161
48083824R ::1(51949)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	/*SELECT COUNT (DISTINCT country) FROM sales WHERE region='Europe';*/
	
	SELECT avg(char_lenght(region)) FROM sales;
48083824R ::1(51949)ERROR:  function blksize(unknown) does not exist at character 208
48083824R ::1(51949)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	/*SELECT COUNT (DISTINCT country) FROM sales WHERE region='Europe';*/
	
	/*SELECT AVG(char_length(order_id)) FROM sales;*/
	
	SELECT blksize('sales');
	
48083824R ::1(51949)ERROR:  syntax error at or near "pg_relation_size" at character 201
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	/*SELECT COUNT (DISTINCT country) FROM sales WHERE region='Europe';*/
	
	/*SELECT AVG(char_length(order_id)) FROM sales;*/
	
	pg_relation_size(reltid)
	
48083824R ::1(51949)ERROR:  column "reltid" does not exist at character 225
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	/*SELECT COUNT (DISTINCT country) FROM sales WHERE region='Europe';*/
	
	/*SELECT AVG(char_length(order_id)) FROM sales;*/
	
	SELECT pg_relation_size(reltid)
	
48083824R ::1(51949)ERROR:  relation "public" does not exist at character 225
48083824R ::1(51949)STATEMENT:  /*SELECT relpages / reltuples AS fr
	FROM pg_class
	WHERE relname = 'sales';*/
	
	/*SELECT COUNT (DISTINCT country) FROM sales WHERE region='Europe';*/
	
	/*SELECT AVG(char_length(order_id)) FROM sales;*/
	
	SELECT pg_relation_size('public')
	
48083824R LOG:  received fast shutdown request
48083824R LOG:  aborting any active transactions
48083824R ::1(53193)FATAL:  terminating connection due to administrator command
48083824R ::1(53181)FATAL:  terminating connection due to administrator command
48083824R LOG:  background worker "logical replication launcher" (PID 10003) exited with exit code 1
48083824R LOG:  shutting down
48083824R LOG:  database system is shut down
48083824R LOG:  starting PostgreSQL 14.7 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-02-15 16:06:19 CET
48083824R LOG:  database system is ready to accept connections
48083824R ::1(54307)LOG:  statement: CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;
	
48083824R ::1(54307)ERROR:  syntax error at or near "PRIMARY" at character 100
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT PRIMARY KEY (order_id);
	
	
48083824R ::1(54307)LOG:  statement: /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY (order_id);
	
	
48083824R ::1(54307)ERROR:  unterminated quoted string at or near "'sales2’" at character 209
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	--ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY (order_id);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales2’
48083824R ::1(54307)ERROR:  syntax error at or near ";" at character 120
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY;
	
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales2'
48083824R ::1(54307)ERROR:  syntax error at end of input at character 205
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY
	
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales2'
48083824R ::1(54307)ERROR:  syntax error at end of input at character 209
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY
	
	/*--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales2'*/
48083824R ::1(54307)ERROR:  syntax error at or near ";" at character 120
48083824R ::1(54307)STATEMENT:  /*CREATE TABLE sales2 AS
	SELECT *
	FROM sales
	ORDER BY region;*/
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY;
	
	/*--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales2'*/
48083824R ::1(54307)ERROR:  syntax error at or near ";" at character 57
48083824R ::1(54307)STATEMENT:  
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY;
	
48083824R ::1(54307)ERROR:  syntax error at end of input at character 57
48083824R ::1(54307)STATEMENT:  
	
	ALTER TABLE sales2 ADD CONSTRAINT order_id PRIMARY KEY
48083824R ::1(54307)ERROR:  unterminated quoted string at or near "'Europe’;" at character 77
48083824R ::1(54307)STATEMENT:  explain (analyze, buffers)
	
	SELECT DISTINCT country FROM sales WHERE region='Europe’;
48083824R ::1(54307)ERROR:  column "‘europe’" does not exist at character 85
48083824R ::1(54307)STATEMENT:  explain (analyze, buffers)
	
	SELECT COUNT (DISTINCT country) FROM sales WHERE region=‘Europe’;
48083824R ::1(55498)LOG:  statement: /*DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)
	*/
	
	CREATE TABLE sales3 AS SELECT * FROM sales ORDER BY region;
	
48083824R LOG:  checkpoints are occurring too frequently (18 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (26 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (7 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (8 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (17 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (9 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (17 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (11 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (18 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R ::1(55498)ERROR:  syntax error at or near "select" at character 165
48083824R ::1(55498)STATEMENT:  DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)
	
	
	--CREATE TABLE sales3 AS SELECT * FROM sales ORDER BY region;
	
	select * from sales3;
48083824R LOG:  checkpoints are occurring too frequently (6 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (7 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (6 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (6 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (7 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (8 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R LOG:  checkpoints are occurring too frequently (9 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R ::1(55498)LOG:  statement: /*DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)*/
	
	DROP TABLE sales3;
	
	
	
48083824R LOG:  checkpoints are occurring too frequently (25 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R ::1(55498)ERROR:  unterminated quoted string at or near "'sales’
	
	" at character 178
48083824R ::1(55498)STATEMENT:  /*DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)*/
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales’
	
	
48083824R ::1(55498)LOG:  statement: /*DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)*/
	
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales'
	
	--select * from sales;
	
	--VACUUM (FULL) sales;
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	PARTITION BY LIST (region);
48083824R ::1(55498)ERROR:  unterminated /* comment at or near "/*
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');" at character 654
48083824R ::1(55498)STATEMENT:  /*DELETE FROM sales WHERE order_id IN (
	SELECT order_id FROM sales ORDER BY random() LIMIT 1000000
	)*/
	
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales'
	
	--select * from sales;
	
	--VACUUM (FULL) sales;
	
	/*CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	PARTITION BY LIST (region);*/
	
	SELECT region FROM sales GROUP BY region;
	/*
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
	CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
48083824R ::1(55498)LOG:  statement: CREATE TABLE Asia PARTITION OF sales3 FOR VALUES IN ('Asia');
48083824R ::1(55498)LOG:  statement: CREATE TABLE AustraliaOceania PARTITION OF sales3 FOR VALUES IN ('Australia and Oceania');
48083824R ::1(55498)LOG:  statement: CREATE TABLE CentralAmericaCaribbean PARTITION OF sales3 FOR VALUES IN ('Central America and the Caribbean');
48083824R ::1(55498)LOG:  statement: CREATE TABLE Europe PARTITION OF sales3 FOR VALUES IN ('Europe');
48083824R ::1(55498)LOG:  statement: CREATE TABLE MiddleEastNorthAfrica PARTITION OF sales3 FOR VALUES IN ('Middle East and North Africa');
48083824R ::1(55498)LOG:  statement: CREATE TABLE NorthAmerica PARTITION OF sales3 FOR VALUES IN ('North America');
48083824R ::1(55498)LOG:  statement: CREATE TABLE SubSaharanAfrica PARTITION OF sales3 FOR VALUES IN ('Sub-Saharan Africa');
48083824R [local]ERROR:  syntax error at or near ";" at character 99
48083824R [local]STATEMENT:  COPY sales3 FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales1.csv' csv header delimiter E';' NULL;
48083824R [local]ERROR:  syntax error at or near "'NULL'" at character 1
48083824R [local]STATEMENT:  'NULL' encoding 'UTF8';
48083824R ::1(57265)ERROR:  unterminated quoted string at or near "'sales3’;" at character 74
48083824R ::1(57265)STATEMENT:  SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'sales3’;
48083824R ::1(57265)ERROR:  column "count" does not exist at character 103
48083824R ::1(57265)HINT:  Perhaps you meant to reference the column "sales.country".
48083824R ::1(57265)STATEMENT:  --SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'subsaharanafrica';
	select count from sales where region='Europe'
48083824R ::1(57265)ERROR:  count(*) must be used to call a parameterless aggregate function at character 103
48083824R ::1(57265)STATEMENT:  --SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'subsaharanafrica';
	select count() from sales where region='Europe'
48083824R ::1(57751)ERROR:  column "‘europe’" does not exist at character 58
48083824R ::1(57751)STATEMENT:  SELECT COUNT (DISTINCT country) FROM sales3 WHERE region=‘Europe’;
48083824R ::1(57751)ERROR:  syntax error at or near "DROP" at character 18
48083824R ::1(57751)STATEMENT:  DROP TABLE sales
	DROP TABLE sales2
	DROP TABLE sales3
48083824R ::1(57751)LOG:  statement: DROP TABLE sales;
	DROP TABLE sales2;
	DROP TABLE sales3;
48083824R [local]LOG:  statement: CREATE TABLE sales (Region text, Country text, Item_Type text, Sales_Channel varchar(7), Order_Priority char(1), Order_Date date, Order_ID varchar(9) PRIMARY KEY, Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision);
48083824R [local]ERROR:  could not open file "/Users/alvarocamacho/Desktop/DatosPL1/sales[].csv" for reading: No such file or directory
48083824R [local]HINT:  COPY FROM instructs the PostgreSQL server process to read a file. You may want a client-side facility such as psql's \copy.
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales[].csv' csv header delimiter ';' NULL 'NULL' encoding 'UTF8';
48083824R [local]ERROR:  syntax error at or near "Poniendo" at character 2
48083824R [local]STATEMENT:  (Poniendo dentro del corchete el numero del archivo (1,2,3,4,5)).
	;
48083824R [local]ERROR:  could not open file "/Users/alvarocamacho/Desktop/DatosPL1/sales.csv" for reading: No such file or directory
48083824R [local]HINT:  COPY FROM instructs the PostgreSQL server process to read a file. You may want a client-side facility such as psql's \copy.
48083824R [local]STATEMENT:  COPY sales FROM '/Users/alvarocamacho/Desktop/DatosPL1/sales.csv' csv header delimiter ';' NULL 'NULL' encoding 'UTF8';
48083824R ::1(57751)LOG:  statement: CREATE INDEX order_id ON sales USING gist (order_id);
	
48083824R ::1(57751)ERROR:  data type character varying has no default operator class for access method "gist"
48083824R ::1(57751)HINT:  You must specify an operator class for the index or define a default operator class for the data type.
48083824R ::1(57751)STATEMENT:  CREATE INDEX order_id ON sales USING gist (order_id);
	
48083824R ::1(57751)LOG:  statement: CREATE INDEX order_id_index ON sales (order_id);
	
48083824R ::1(57751)ERROR:  syntax error at or near "-" at character 52
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	-analyze
	SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	
48083824R ::1(57751)ERROR:  unterminated quoted string at or near "'order_id_index’;" at character 202
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	--analyze
	--SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_index’;
48083824R ::1(57751)ERROR:  column "name" does not exist at character 228
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	--analyze
	SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_index';
	
	SELECT name, number_of_levels 
	FROM pg_class, pg_index 
	WHERE pg_class.oid = pg_index.indexrelid AND pg_class.relname = 'order_id_index';
	
48083824R ::1(57751)ERROR:  column "name" does not exist at character 230
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	--analyze
	--SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_index';
	
	SELECT name, number_of_levels 
	FROM pg_class, pg_index 
	WHERE pg_class.oid = pg_index.indexrelid AND pg_class.relname = 'order_id_index';
	
48083824R ::1(57751)ERROR:  column "number_of_levels" does not exist at character 230
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	--analyze
	--SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_index';
	
	SELECT number_of_levels 
	FROM pg_class, pg_index 
	WHERE pg_class.oid = pg_index.indexrelid AND pg_class.relname = 'order_id_index';
	
48083824R ::1(57751)ERROR:  column "name" does not exist at character 230
48083824R ::1(57751)STATEMENT:  --CREATE INDEX order_id_index ON sales (order_id);
	--analyze
	--SELECT pg_size_pretty(pg_total_relation_size('order_id_index'));
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_index';
	
	SELECT name, number_of_levels 
	FROM pg_class, pg_index 
	WHERE pg_class.oid = pg_index.indexrelid AND pg_class.relname = 'order_id_index';
	
48083824R LOG:  received smart shutdown request
48083824R LOG:  background worker "logical replication launcher" (PID 82384) exited with exit code 1
48083824R LOG:  shutting down
48083824R LOG:  database system is shut down
48083824R LOG:  starting PostgreSQL 14.7 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-02-23 16:42:30 CET
48083824R LOG:  database system is ready to accept connections
48083824R ::1(49306)ERROR:  column "indexname" does not exist at character 69
48083824R ::1(49306)STATEMENT:  --SELECT pg_relation_filepath('order_id_index');
	
	SELECT tablename, indexname, tree_level
	FROM pg_stats
	WHERE tablename = 'sales' AND indexname = 'order_id_index';
	
48083824R ::1(49306)ERROR:  column "indexname" does not exist at character 58
48083824R ::1(49306)STATEMENT:  --SELECT pg_relation_filepath('order_id_index');
	
	SELECT indexname, indisunique, indisprimary, indisclustered, indnatts, 
	  pg_get_indexdef(indexrelid) AS indexdef
	FROM pg_index
	WHERE indrelid = 'sales'::regclass;
	
48083824R ::1(49306)ERROR:  column "indexname" does not exist at character 104
48083824R ::1(49306)STATEMENT:  --SELECT pg_relation_filepath('order_id_index');
	
	SELECT *
	FROM pg_stats
	WHERE tablename = 'sales' AND indexname = 'order_id_index';
	
	
48083824R ::1(49306)ERROR:  "order_id_index" is an index at character 65
48083824R ::1(49306)STATEMENT:  --SELECT pg_relation_filepath('order_id_index');
	
	select * from order_id_index;
48083824R ::1(49306)WARNING:  skipping "order_id_index" --- cannot analyze non-tables or special system tables
48083824R ::1(50028)ERROR:  function pgstattuple(unknown) does not exist at character 15
48083824R ::1(50028)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50028)STATEMENT:  SELECT * FROM pgstattuple('pg_catalog.pg_proc');
48083824R ::1(50028)ERROR:  syntax error at or near "get_raw_page" at character 52
48083824R ::1(50028)STATEMENT:  --SELECT * FROM pgstattuple('pg_catalog.pg_proc');
	get_raw_page(relname text, fork text, blkno bigint) returns bytea
48083824R ::1(50028)ERROR:  function pgstattuple(unknown) does not exist at character 15
48083824R ::1(50028)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50028)STATEMENT:  SELECT * FROM pgstattuple('sales.region');
	
48083824R ::1(50028)LOG:  statement: --SELECT * FROM pgstattuple('pg_catalog.pg_proc');
	CREATE EXTENSION pgstattuple;
48083824R ::1(50028)ERROR:  schema "sales" does not exist
48083824R ::1(50028)STATEMENT:  SELECT * FROM pgstattuple('sales.region');
	--CREATE EXTENSION pgstattuple;
48083824R ::1(50028)LOG:  statement: --SELECT * FROM pgstattuple('order_id_index');
	CREATE EXTENSION pageinspect;
48083824R ::1(50028)LOG:  statement: --SELECT * FROM pgstattuple('order_id_index');
	CREATE EXTENSION pgstatindex;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	SELECT * FROM bt_metap('order_id_index');
48083824R ::1(50028)ERROR:  could not open extension control file "/Applications/Postgres.app/Contents/Versions/14/share/postgresql/extension/pgstatindex.control": No such file or directory
48083824R ::1(50028)STATEMENT:  --SELECT * FROM pgstattuple('order_id_index');
	CREATE EXTENSION pgstatindex;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	SELECT * FROM bt_metap('order_id_index');
48083824R ::1(50028)ERROR:  relation "sales" is not a btree index
48083824R ::1(50028)STATEMENT:  --SELECT * FROM pgstattuple('order_id_index');
	--CREATE EXTENSION pgstatindex;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	--SELECT * FROM bt_metap('order_id_index');
	SELECT * FROM pgstatindex('sales');
48083824R ::1(50028)ERROR:  function pg_block_size(integer) does not exist at character 256
48083824R ::1(50028)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50028)STATEMENT:  --SELECT * FROM pgstattuple('order_id_index');
	--CREATE EXTENSION pgstatindex;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	--SELECT * FROM bt_metap('order_id_index');
	--SELECT * FROM pgstatindex('order_id_index');
	SELECT lenght(pointer) FROM pg_block_size(8192)
48083824R ::1(50028)LOG:  statement: --SELECT * FROM pgstattuple('order_id_index');
	CREATE EXTENSION pg_block_size;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	--SELECT * FROM bt_metap('order_id_index');
	--SELECT * FROM pgstatindex('order_id_index');
	--SELECT lenght(pointer) FROM pg_block_size(8192)
48083824R ::1(50028)ERROR:  could not open extension control file "/Applications/Postgres.app/Contents/Versions/14/share/postgresql/extension/pg_block_size.control": No such file or directory
48083824R ::1(50028)STATEMENT:  --SELECT * FROM pgstattuple('order_id_index');
	CREATE EXTENSION pg_block_size;
	
	--SELECT page_checksum(get_raw_page('pg_class', 0), 0);
	--SELECT * FROM bt_metap('order_id_index');
	--SELECT * FROM pgstatindex('order_id_index');
	--SELECT lenght(pointer) FROM pg_block_size(8192)
48083824R ::1(50028)ERROR:  function pg_block_size(integer) does not exist at character 29
48083824R ::1(50028)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50028)STATEMENT:  SELECT lenght(pointer) FROM pg_block_size(8192)
48083824R LOG:  received smart shutdown request
48083824R LOG:  background worker "logical replication launcher" (PID 1320) exited with exit code 1
48083824R LOG:  shutting down
48083824R LOG:  database system is shut down
48083824R LOG:  starting PostgreSQL 14.7 on aarch64-apple-darwin20.6.0, compiled by Apple clang version 12.0.5 (clang-1205.0.22.9), 64-bit
48083824R LOG:  listening on IPv6 address "::1", port 5432
48083824R LOG:  listening on IPv4 address "127.0.0.1", port 5432
48083824R LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
48083824R LOG:  database system was shut down at 2023-03-01 11:54:33 CET
48083824R LOG:  database system is ready to accept connections
48083824R ::1(49939)LOG:  statement: CREATE INDEX order_id_index ON sales (units_sold);
48083824R ::1(49939)ERROR:  relation "order_id_index" already exists
48083824R ::1(49939)STATEMENT:  CREATE INDEX order_id_index ON sales (units_sold);
48083824R ::1(49939)LOG:  statement: CREATE INDEX units_sold_index ON sales (units_sold);
48083824R ::1(49939)ERROR:  syntax error at or near "’" at character 317
48083824R ::1(49939)STATEMENT:  --CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	SELECT * FROM pgstatindex(‘units_sold_index’);’
48083824R ::1(49939)LOG:  statement: /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
48083824R ::1(49939)LOG:  statement: /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
48083824R ::1(49939)ERROR:  relation "order_id_hash_index" already exists
48083824R ::1(49939)STATEMENT:  /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
48083824R ::1(49939)ERROR:  function idx_hash_nbucket(oid) does not exist at character 620
48083824R ::1(49939)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(49939)STATEMENT:  /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	/*CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
	SELECT pg_relation_filepath('order_id_hash_index');*/
	
	SELECT idx_hash_nbucket(indexrelid)
	FROM pg_index
	JOIN pg_class ON pg_index.indexrelid = pg_class.oid
	WHERE pg_class.relname = 'order_id_hash_index';
	
48083824R ::1(49939)ERROR:  function idx_hash_nbucket(regclass) does not exist at character 620
48083824R ::1(49939)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(49939)STATEMENT:  /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	/*CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
	SELECT pg_relation_filepath('order_id_hash_index');*/
	
	SELECT idx_hash_nbucket('order_id_hash_index'::regclass);
	
	
48083824R ::1(49939)LOG:  statement: CREATE EXTENSION IF NOT EXISTS pgstattuple;
48083824R ::1(49939)ERROR:  function idx_hash_nbucket(regclass) does not exist at character 620
48083824R ::1(49939)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(49939)STATEMENT:  /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	/*CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
	SELECT pg_relation_filepath('order_id_hash_index');*/
	
	SELECT idx_hash_nbucket('order_id_hash_index'::regclass);
	
	
48083824R ::1(49939)ERROR:  function json_extract_path_text(record, unknown) does not exist at character 715
48083824R ::1(49939)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(49939)STATEMENT:  /*--CREATE INDEX units_sold_index ON sales (units_sold);
	--SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_index';
	--SELECT pg_size_pretty(pg_total_relation_size('units_sold_index'));
	--SELECT pg_relation_filepath('units_sold_index');
	--SELECT * FROM pgstatindex('units_sold_index');*/
	
	/*CREATE INDEX order_id_hash_index ON sales USING HASH (order_id);
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'order_id_hash_index';
	SELECT pg_size_pretty(pg_total_relation_size('order_id_hash_index'));
	SELECT pg_relation_filepath('order_id_hash_index');*/
	
	/*select ntuples, maxbucket
	from hash_metapage_info(get_raw_page('order_id_hash_index',0));*/
	
	SELECT json_extract_path_text(stats, 'hash_buckets') AS num_buckets
	FROM (SELECT pgstatindex('order_id_hash_index') AS stats) AS sub;
	
48083824R ::1(50620)LOG:  statement: CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
48083824R ::1(50620)ERROR:  unterminated quoted string at or near "'units_sold_hash_index’);" at character 29
48083824R ::1(50620)STATEMENT:  SELECT pg_relation_filepath('units_sold_hash_index’);
48083824R ::1(50620)LOG:  statement: CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
48083824R ::1(50620)ERROR:  relation "units_sold_hash_index" already exists
48083824R ::1(50620)STATEMENT:  CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
48083824R ::1(50620)LOG:  statement: CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
	
	explain
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387072.00
48083824R ::1(50620)ERROR:  relation "units_sold_hash_index" already exists
48083824R ::1(50620)STATEMENT:  CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
	
	explain
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387072.00
48083824R ::1(50620)ERROR:  syntax error at or near "," at character 349
48083824R ::1(50620)STATEMENT:  CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
	
	explain
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387,072.00
48083824R ::1(50620)ERROR:  syntax error at or near "," at character 8
48083824R ::1(50620)STATEMENT:  explain, analyze
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387072.00
48083824R ::1(50620)ERROR:  syntax error at or near "," at character 305
48083824R ::1(50620)STATEMENT:  CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');
	
	analyze, explain
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387072.00
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 18
48083824R ::1(50620)STATEMENT:  analyze explain
	
	SELECT * 
	FROM sales
	WHERE total_cost= 387072.00
48083824R ::1(50620)ERROR:  syntax error at or near ".00" at character 391
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT count(order_id)
	FROM sales
	WHERE total_cost > 32.000.00 and total_cost < 100000.00
48083824R ::1(50620)ERROR:  column "index_relation_oid" does not exist at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(index_relation_oid)
	
	
48083824R ::1(50620)ERROR:  column "order_id_index" does not exist at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(order_id_index)
	
	
48083824R ::1(50620)ERROR:  column "order_id_index" does not exist at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(order_id_index);
	
	
48083824R ::1(50620)ERROR:  column "units_sold_index" does not exist at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(units_sold_index);
	
	
48083824R ::1(50620)ERROR:  missing FROM-clause entry for table "sales" at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(sales.order_id_index);
	
	
48083824R ::1(50620)ERROR:  column "order_id_index" does not exist at character 360
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats(order_id_index, 1);
	
	
48083824R ::1(50620)ERROR:  function bt_page_stats(unknown) does not exist at character 346
48083824R ::1(50620)HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	SELECT * FROM bt_page_stats('order_id_index');
	
	
48083824R ::1(50620)ERROR:  relation "order_id_hash_index" is not a btree index
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	--SELECT * FROM bt_page_stats('order_id_index', 2);
	
	SELECT * FROM pgstatindex('order_id_hash_index');
48083824R ::1(50620)ERROR:  block number out of range
48083824R ::1(50620)STATEMENT:  SELECT * FROM bt_page_stats('order_id_index', 19256);
48083824R ::1(50620)ERROR:  block number out of range
48083824R ::1(50620)STATEMENT:  SELECT * FROM bt_page_stats('order_id_index', 19255);
48083824R ::1(50620)ERROR:  relation "sys.dm_db_xtp_hash_index_stats" does not exist at character 641
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	--SELECT * FROM bt_page_stats('order_id_index', 5);
	
	--SELECT * FROM pgstatindex('order_id_hash_index');
	
	SELECT OBJECT_NAME(S.object_id) as sales
	     , I.name AS order_id_hash_index
	        , S.total_bucket_count
	        , S.empty_bucket_count
	        , S.avg_chain_length
	        , S.max_chain_length
	FROM sys.dm_db_xtp_hash_index_stats S
	JOIN sys.indexes I
	on S.index_id = I.index_id
	   AND 
	   S.object_id = I.object_id;
48083824R ::1(50620)ERROR:  "order_id_hash_index" is not a btree index
48083824R ::1(50620)STATEMENT:  SELECT * FROM bt_page_stats('order_id_hash_index', 5);
	
48083824R ::1(50620)ERROR:  "order_id_hash_index" is an index at character 474
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	--SELECT * FROM bt_page_stats('order_id_hash_index', 5);
	
	--SELECT * FROM pgstatindex('order_id_hash_index');
	
	SELECT total_bucket_count from order_id_hash_index
48083824R ::1(50620)ERROR:  "order_id_hash_index" is an index at character 476
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	--SELECT * FROM bt_page_stats('order_id_hash_index', 5);
	
	--SELECT * FROM pgstatindex('order_id_hash_index');
	
	SELECT S.total_bucket_count from order_id_hash_index
48083824R ::1(50620)ERROR:  "order_id_hash_index" is an index at character 494
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX units_sold_hash_index ON sales USING HASH (units_sold);
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'units_sold_hash_index';
	
	SELECT pg_size_pretty(pg_total_relation_size('units_sold_hash_index'));
	
	SELECT pg_relation_filepath('units_sold_hash_index');*/
	
	--explain (analyze, buffers)
	
	--SELECT * FROM bt_page_stats('order_id_hash_index', 5);
	
	--SELECT * FROM pgstatindex('order_id_hash_index');
	
	SELECT order_id_hash_index.total_bucket_count from order_id_hash_index
48083824R [local]LOG:  statement: CREATE TABLE sales2 (Region text, Country text, Item_Type text, Sales_Channel varchar(7), Order_Priority char(1), Order_Date date, Order_ID varchar(9) PRIMARY KEY, Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision);
48083824R ::1(50620)LOG:  statement: CREATE INDEX order_id_hash_index ON sales2 USING HASH (order_id);
48083824R ::1(50620)ERROR:  relation "order_id_hash_index" already exists
48083824R ::1(50620)STATEMENT:  CREATE INDEX order_id_hash_index ON sales2 USING HASH (order_id);
48083824R ::1(50620)LOG:  statement: CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
48083824R ::1(50620)LOG:  statement: CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
48083824R LOG:  checkpoints are occurring too frequently (14 seconds apart)
48083824R HINT:  Consider increasing the configuration parameter "max_wal_size".
48083824R ::1(50620)LOG:  statement: CREATE INDEX total_cost_index2 ON sales2 (total_cost);
48083824R ::1(50620)LOG:  statement: /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id=‘100565711’
	
48083824R ::1(50620)ERROR:  column "‘100565711’" does not exist at character 259
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id=‘100565711’
	
48083824R ::1(50620)LOG:  statement: /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT pg_relation_filepath(oid), relpages FROM pg_class WHERE relname = 'consulta1';
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	SELECT * 
	FROM sales
	WHERE order_date like '2022';
48083824R ::1(50620)ERROR:  operator does not exist: date ~~ unknown at character 39
48083824R ::1(50620)HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
48083824R ::1(50620)STATEMENT:  SELECT * 
	FROM sales
	WHERE order_date like '2022';
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	SELECT *
	FROM sales
	WHERE order_date BETWEEN '2022-01-01' AND '2022-12-31';
	
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	
	SELECT *
	FROM sales
	WHERE (order_date BETWEEN '2018-01-01' AND '2018-12-31') AND (order_date BETWEEN '2001-01-01' AND '2001-12-31')
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	
	SELECT *
	FROM sales
	WHERE (order_date BETWEEN '2018-01-01' AND '2018-12-31') OR (order_date BETWEEN '2001-01-01' AND '2001-12-31')
48083824R ::1(50620)LOG:  statement: CREATE VIEW query_stats AS
	SELECT query, calls, total_time, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  relation "pg_stat_statements" does not exist at character 75
48083824R ::1(50620)STATEMENT:  CREATE VIEW query_stats AS
	SELECT query, calls, total_time, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)LOG:  statement: CREATE EXTENSION pg_stat_statements
48083824R ::1(50620)LOG:  statement: CREATE VIEW query_stats AS
	SELECT query, calls, total_time, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  column "total_time" does not exist at character 49
48083824R ::1(50620)STATEMENT:  CREATE VIEW query_stats AS
	SELECT query, calls, total_time, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	CREATE EXTENSION pg_stat_statements
	CREATE VIEW query_stats AS
	SELECT query, calls, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
	
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	
	PARTITION BY LIST (region);
	
	SELECT region FROM sales GROUP BY region;
	
	CREATE TABLE [region] PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
48083824R ::1(50620)ERROR:  syntax error at or near "CREATE" at character 37
48083824R ::1(50620)STATEMENT:  CREATE EXTENSION pg_stat_statements
	CREATE VIEW query_stats AS
	SELECT query, calls, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  syntax error at or near "CREATE" at character 37
48083824R ::1(50620)STATEMENT:  CREATE EXTENSION pg_stat_statements
	CREATE VIEW query_stats AS
	SELECT query, calls, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)LOG:  statement: CREATE VIEW query_stats AS
	SELECT query, calls, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  column "blk_read" does not exist at character 49
48083824R ::1(50620)STATEMENT:  CREATE VIEW query_stats AS
	SELECT query, calls, blk_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	CREATE EXTENSION pg_stat_statements
	CREATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
	
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	
	PARTITION BY LIST (region);
	
	SELECT region FROM sales GROUP BY region;
	
	CREATE TABLE [region] PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
48083824R ::1(50620)LOG:  statement: CREATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  syntax error at or near "UPDATE" at character 11
48083824R ::1(50620)STATEMENT:  CREATE OR UPDATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit, shared_blks_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 272
48083824R ::1(50620)STATEMENT:  /*CREATE INDEX order_id_hash_index2 ON sales2 USING HASH (order_id);
	CREATE INDEX total_cost_hash_index2 ON sales2 USING HASH (total_cost);
	CREATE INDEX total_cost_index2 ON sales2 (total_cost);*/
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT relpages FROM pg_class WHERE relname = 'consulta1';
	
	CREATE EXTENSION pg_stat_statements
	
	CREATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit, shared_blks_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
	
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	
	PARTITION BY LIST (region);
	
	SELECT region FROM sales GROUP BY region;
	
	CREATE TABLE [region] PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
48083824R ::1(50620)LOG:  statement: CREATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit, shared_blks_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  relation "query_stats" already exists
48083824R ::1(50620)STATEMENT:  CREATE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit, shared_blks_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)LOG:  statement: CREATE OR REPLACE VIEW query_stats AS
	SELECT query, calls, shared_blks_hit, shared_blks_read
	FROM pg_stat_statements
	WHERE query <> '<insufficient privilege>';
48083824R ::1(50620)ERROR:  invalid input syntax for type boolean: "Oceania" at character 89
48083824R ::1(50620)STATEMENT:  SELECT count(order_id) 
	FROM sales
	WHERE country = 'Mexico' OR region = 'Australia' and 'Oceania';
48083824R ::1(50620)ERROR:  column "total_time" does not exist at character 68
48083824R ::1(50620)STATEMENT:  SELECT shared_blks_hit, shared_blks_read FROM query_stats ORDER BY total_time DESC LIMIT 1;
	
48083824R ::1(50620)ERROR:  syntax error at or near "DESC" at character 59
48083824R ::1(50620)STATEMENT:  SELECT shared_blks_hit, shared_blks_read FROM query_stats DESC LIMIT 1;
	
48083824R ::1(50620)ERROR:  pg_stat_statements must be loaded via shared_preload_libraries
48083824R ::1(50620)STATEMENT:  SELECT shared_blks_hit, shared_blks_read FROM query_stats LIMIT 1;
	
48083824R ::1(50620)LOG:  statement: CREATE EXTENSION pg_stat_statements
48083824R ::1(50620)ERROR:  extension "pg_stat_statements" already exists
48083824R ::1(50620)STATEMENT:  CREATE EXTENSION pg_stat_statements
48083824R ::1(50620)ERROR:  pg_stat_statements must be loaded via shared_preload_libraries
48083824R ::1(50620)STATEMENT:  SELECT shared_blks_hit, shared_blks_read FROM query_stats LIMIT 1;
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 74
48083824R ::1(50620)STATEMENT:  CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT oid FROM pg_class WHERE relname = 'consulta1';
	
	SELECT idx_blks_read FROM pg_stat_all_tables WHERE relname = '16546'
	
	
	
	
	
	
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	
	PARTITION BY LIST (region);
	
	SELECT region FROM sales GROUP BY region;
	
	CREATE TABLE [region] PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
48083824R ::1(50620)ERROR:  column "idx_blks_read" does not exist at character 8
48083824R ::1(50620)STATEMENT:  SELECT idx_blks_read FROM pg_stat_all_tables WHERE relname = '16546'
	
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 74
48083824R ::1(50620)STATEMENT:  CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT oid FROM pg_class WHERE relname = 'consulta1';
	
	SELECT idx_blks_read FROM pg_statio_all_indexes WHERE relname = 'order_id_index'
	SELECT idx_blks_read FROM pg_statio_all_tables WHERE relname = '16546'
	
	
	
	
	
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	
	PARTITION BY LIST (region);
	
	SELECT region FROM sales GROUP BY region;
	
	CREATE TABLE [region] PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
48083824R ::1(50620)ERROR:  syntax error at or near "bt_page_stats" at character 1
48083824R ::1(50620)STATEMENT:  bt_page_stats('units_sold_index',2) 
48083824R ::1(50620)ERROR:  syntax error at or near "SELECT" at character 117
48083824R ::1(50620)STATEMENT:  --SABER DATOS DE LAS CONSULTAS CON VISTAS
	
	CREATE VIEW consulta1 AS
	SELECT *
	FROM sales
	WHERE order_id='100565711'
	
	SELECT oid FROM pg_class WHERE relname = 'consulta1';
	
	SELECT idx_blks_read FROM pg_statio_all_indexes WHERE relname = '16546'
	SELECT idx_blks_read FROM pg_statio_all_tables WHERE relname = '16546'
	
	SELECT * FROM sales ORDER BY order_date ASC
	
	
	--TABLA PARTICIONADA POR AÑO
	
	CREATE TABLE sales3 (Region text, Country text, 
	Item_Type text, Sales_Channel varchar(7), 
	Order_Priority char(1), Order_Date date, Order_ID varchar(9), 
	Ship_Date date, Units_Sold integer, Unit_Price double precision, Unit_Cost double precision, 
	Total_Revenue double precision, Total_Cost double precision, Total_Profit double precision) 
	PARTITION BY LIST (order_date);
	
	SELECT order_date FROM sales GROUP BY order_date;
	
	CREATE TABLE 2010 PARTITION OF sales3 FOR VALUES IN ([‘region’]);
	
	COPY sales3 FROM [ruta] csv header delimiter E';' NULL 'NULL' encoding 'UTF8';
	
	--Automáticamente se llenan las tablas de cada región. Lo que hemos hecho ha sido ‘dividir’ la tabla sales3 en 7 tablas diferentes con cada región. 
	
	
	select * from bt_page_stats('units_sold_index',100) 
48083824R ::1(50620)ERROR:  relation "units_sold" does not exist
48083824R ::1(50620)STATEMENT:  select * from bt_page_stats('units_sold',100) 
48083824R ::1(50620)ERROR:  "sales" is not a btree index
48083824R ::1(50620)STATEMENT:  select * from bt_page_stats('sales',100) 
